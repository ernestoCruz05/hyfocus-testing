# Codebase Structure

**Analysis Date:** 2026-01-08

## Directory Layout

```
hyfocus/
├── src/                    # C++ source code
│   ├── main.cpp           # Plugin entry point, config loading
│   ├── globals.hpp        # Global state, forward declarations
│   ├── log.hpp            # Logging macros
│   ├── dispatchers.cpp    # User command handlers
│   ├── dispatchers.hpp    # Dispatcher declarations
│   ├── eventhooks.cpp     # Event interception logic
│   ├── eventhooks.hpp     # Event hook declarations
│   ├── FocusTimer.cpp     # Pomodoro timer implementation
│   ├── FocusTimer.hpp     # Timer class definition
│   ├── WorkspaceEnforcer.cpp  # Workspace validation
│   ├── WorkspaceEnforcer.hpp  # Enforcer class definition
│   ├── WindowShake.cpp    # Shake animation implementation
│   ├── WindowShake.hpp    # Shake class definition
│   ├── ExitChallenge.cpp  # Exit minigame implementation
│   └── ExitChallenge.hpp  # Challenge class definition
├── build/                  # CMake build artifacts (gitignored)
├── CMakeLists.txt         # CMake build configuration
├── meson.build            # Meson build configuration
├── hyprpm.toml            # Plugin manifest for hyprpm
├── LICENSE                # MIT license
├── README.md              # User documentation
└── .gitignore             # Build artifacts exclusions
```

## Directory Purposes

**src/**
- Purpose: All C++ source code
- Contains: `.cpp` implementation files and `.hpp` header files
- Key files: `main.cpp` (entry), `globals.hpp` (shared state)
- Subdirectories: None (flat structure)

**build/**
- Purpose: CMake build artifacts
- Contains: Compiled objects, `libhyfocus.so` output
- Source: Generated by CMake build process
- Committed: No (in .gitignore)

## Key File Locations

**Entry Points:**
- `src/main.cpp` - Plugin initialization (`PLUGIN_INIT`) and cleanup (`PLUGIN_EXIT`)

**Configuration:**
- `CMakeLists.txt` - CMake build configuration
- `meson.build` - Meson build configuration
- `hyprpm.toml` - Plugin metadata for hyprpm distribution

**Core Logic:**
- `src/FocusTimer.cpp/hpp` - Pomodoro timer with work/break cycles
- `src/WorkspaceEnforcer.cpp/hpp` - Workspace access control
- `src/WindowShake.cpp/hpp` - Visual feedback animation
- `src/ExitChallenge.cpp/hpp` - Exit challenge minigames

**API/Commands:**
- `src/dispatchers.cpp/hpp` - User command implementations
- `src/eventhooks.cpp/hpp` - Event interception hooks

**Shared State:**
- `src/globals.hpp` - Global variables, forward declarations, helper functions
- `src/log.hpp` - Logging macros (FE_DEBUG, FE_INFO, etc.)

**Documentation:**
- `README.md` - User-facing installation and usage guide
- `LICENSE` - MIT license

## Naming Conventions

**Files:**
- PascalCase for class files: `FocusTimer.cpp`, `WorkspaceEnforcer.hpp`
- lowercase for non-class files: `main.cpp`, `dispatchers.cpp`, `globals.hpp`
- `.cpp` for implementation, `.hpp` for headers

**Directories:**
- lowercase: `src/`, `build/`
- Flat structure (no nested directories in src/)

**Special Patterns:**
- Implementation pairs: `ClassName.cpp` + `ClassName.hpp`
- No barrel/index files (C++ doesn't use them)

## Where to Add New Code

**New Feature/Component:**
- Primary code: `src/NewComponent.cpp` and `src/NewComponent.hpp`
- Registration: Add instantiation in `src/main.cpp` PLUGIN_INIT
- Cleanup: Add destruction in `src/main.cpp` PLUGIN_EXIT
- Add to CMakeLists.txt sources list

**New User Command:**
- Declaration: `src/dispatchers.hpp` (add dispatch function declaration)
- Implementation: `src/dispatchers.cpp` (add dispatch function)
- Registration: `src/main.cpp` in `registerDispatchers()` call

**New Event Hook:**
- Declaration: `src/eventhooks.hpp`
- Implementation: `src/eventhooks.cpp`
- Registration: `src/eventhooks.cpp` in `registerEventHooks()`

**New Global State:**
- Add to: `src/globals.hpp` with `g_fe_` prefix
- Initialize in: `src/main.cpp` PLUGIN_INIT
- Cleanup in: `src/main.cpp` PLUGIN_EXIT if needed

**New Logging:**
- Use macros from `src/log.hpp`: `FE_DEBUG()`, `FE_INFO()`, `FE_WARN()`, `FE_ERR()`

## Special Directories

**build/**
- Purpose: Build artifacts
- Source: Auto-generated by CMake/Meson
- Committed: No (gitignored)
- Output: `libhyfocus.so`

**.planning/**
- Purpose: Planning documentation (this codebase map)
- Source: Created by GSD workflow
- Committed: Yes

---

*Structure analysis: 2026-01-08*
*Update when directory structure changes*
